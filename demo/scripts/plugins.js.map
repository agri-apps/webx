{"version":3,"file":"plugins.js","sources":["../../src/utils/dom.js","../../src/plugins/nav/index.js","../../src/plugins/nav/browser.js","../../src/plugins/typer/index.js","../../src/plugins/typer/browser.js","../../src/plugins/templater/index.js","../../src/plugins/templater/browser.js"],"sourcesContent":["export const addClass = (cls, el) => {\n  if (!cls || !el) {\n    return;\n  }\n  if (typeof cls === \"string\") {\n    el.classList.add.apply(el.classList, cls.split(\" \"));\n  } else if (Array.isArray(cls)) {\n    el.classList.add.apply(el.classList, cls);\n  }\n};\n\nconst _removeClassArr = (arr, el) => {\n  arr.forEach((cls) => {\n    if (el.classList.contains(cls)) {\n      el.classList.remove(cls);\n    }\n  });\n};\n\nexport const removeClass = (cls, el) => {\n  if (!cls || !el) {\n    return;\n  }\n  if (typeof cls === \"string\") {\n    _removeClassArr(cls.split(\" \"), el);\n  } else if (Array.isArray(cls)) {\n    _removeClassArr(cls, el);\n  }\n};\n","import { addClass, removeClass } from './../../utils/dom';\n/*\n * Example plugin that hightlights anchors based on extra route data.\n * See routes in index.html for configuration.\n */\nexport default {\n    name: \"webx1NavPlugin\",\n    global: \"$\",\n    namespace: \"nav\",\n    install: (app, options) => {\n      let opts = Object.assign({ activeClassName: \"active \" }, options);\n  \n      let origInitRoute = app.initRoute;\n      let origUnmountRoute = app.unmountRoute;\n      let origBoot = app.boot;\n  \n      let rootEl = opts.scope ? document.querySelector(opts.scope) : app.el;\n  \n      app.initRoute = async (route, state) => {\n        await origInitRoute(route, state);\n        const routeMap = Object.keys(app.routes).reduce((prev, curr) => {\n          let rt = app.routes[curr];\n          if (rt.name) {\n            prev[rt.name] = {\n              root: rt.root,\n              path: curr,\n              activeClass: rt.activeClass || opts.activeClassName,\n            };\n          }\n          return prev;\n        }, {});\n        let links = [].slice.call(rootEl.querySelectorAll(\"a[data-route]\"));\n  \n        links.forEach((anchor) => {\n          let routeName = anchor.dataset[\"route\"];\n          let current = routeMap[routeName] || {};\n  \n          if (current.activeClassName) {\n            anchor.dataset[\"activeClass\"] = activeClass;\n          }\n  \n          anchor.addEventListener(\"click\", (e) => {\n            e.preventDefault();\n  \n            let { path, activeClass, root } =\n              routeMap[e.target.dataset[\"route\"]] || {};\n            if (path) {\n              let href = e.target.href;\n              let currPath = href.replace(window.location.origin, \"\");\n  \n              window.history.pushState({}, currPath, href);\n              app.navigate(e.target.pathname);\n  \n              let anchor = root\n                ? rootEl.querySelector(`[data-route=\"${root}\"]`)\n                : e.target;\n  \n              if (anchor) {\n                if (activeClass) {\n                  anchor.dataset[\"activeClass\"] = activeClass;\n                }\n                addClass(activeClass || opts.activeClassName, anchor);\n              }\n            }\n          });\n        });\n      };\n  \n      app.unmountRoute = (route, state) => {\n        origUnmountRoute.call(app, route, state);\n        [].slice\n          .call(rootEl.querySelectorAll(\"a[data-route]\"))\n          .forEach((link) => { \n            removeClass(link.dataset[\"activeClass\"] || opts.activeClassName, link);\n          });\n      };\n  \n      app.boot = async () => {\n        await origBoot.call(app);\n        let pathname = window.location.pathname;\n  \n        if (pathname) {\n          let currentRoute = await app.getRoute(pathname);\n          if (currentRoute && currentRoute.name) {\n            let routeName = currentRoute.root\n              ? currentRoute.root\n              : currentRoute.name;\n            let anchor = rootEl.querySelector(`[data-route=\"${routeName}\"]`);\n            if (anchor) {\n              let cls = currentRoute.activeClass || opts.activeClassName;\n              addClass(cls, anchor);\n              anchor.dataset[\"activeClass\"] = cls;\n            }\n          }\n        }\n      };\n  \n      // API to return\n      return {\n        getRouteElements: () => {\n          return [].slice.call(rootEl.querySelectorAll(\"[data-route]\"));\n        },\n      };\n    },\n  };\n  ","import webx1NavPlugin from './index';\n\nif (typeof window !== undefined) {\n    window.webx1NavPlugin = webx1NavPlugin;\n}","const defaultOptions = { speed: 100 };\n\nexport default {\n  name: \"webx1TyperPlugin\",\n  global: \"$\",\n  namespace: \"typer\",\n  install: (app, options = {}) => {\n    let opts = Object.assign({}, defaultOptions, options);\n    let rootEl = opts.scope ? document.querySelector(opts.scope) : app.el;\n    let origInitRoute = app.initRoute;\n\n    const run = () => {\n        [].slice.call(rootEl.querySelectorAll(\"[data-typer]\")).forEach((el) => {\n            let text = el.dataset[\"typer\"] || el.textContent;\n            let speed = el.hasAttribute(\"data-speed\")\n              ? parseInt(el.dataset[\"speed\"])\n              : opts.speed;\n            typewriter(text, speed, el.hasAttribute('data-replace'), el.hasAttribute('data-repeat'), el.getAttribute('data-append')).typeIt(el, text);\n          });\n    }\n\n    app.initRoute = async (route, state) => {\n      await origInitRoute.call(app, route, state);\n        run();      \n    };\n\n    function typewriter(text, speed, replace = false, repeat = false, append = '') {\n      let i = 0;\n      let txt = text;\n      let origText = text;\n\n      if (!speed) {\n        speed = 100;\n      }\n\n      const api = {\n        typeIt: function (el, str) {\n          let ts;\n          if (str) {\n            txt = str;\n            i = 0;\n          }\n          if (el) {\n            api.el = el;\n          }\n\n          if (i < txt.length) {\n            el.textContent = replace ? txt.charAt(i) : (el.textContent + txt.charAt(i));\n            if (append) {\n                el.textContent = el.textContent + append\n            }\n            i++;\n            ts = setTimeout(api.typeIt.bind(null, el), speed);\n          } else {\n              if (repeat) {\n                  el.textContent = '';\n                  ts = setTimeout(api.typeIt.bind(null, el, origText))\n              }\n          }\n          return {\n              stop: () => {\n                  if (ts) {\n                    clearTimeout(ts);\n                  }                \n              }\n          }\n        },\n      };\n      return api;\n    }\n\n    return {\n      typeIt: (el, text, speed = opts.speed, replace) => {\n        return typewriter(text, speed, replace).typeIt(el, text);\n      },\n      run\n    };\n  },\n};\n","import webx1TyperPlugin from './index';\n\nif (typeof window !== undefined) {\n    window.webx1TyperPlugin = webx1TyperPlugin;\n}","const defaultOptions = { clobber: true };\n\nexport default {\n  name: \"webx1TemplaterPlugin\",\n  global: \"$\",\n  namespace: \"template\",\n  install: (app, options = {}) => {\n    const templateCache = {};\n    const listeners = {};\n\n    let opts = Object.assign({}, defaultOptions, options);\n    let rootEl = opts.scope ? document.querySelector(opts.scope) : app.el;\n\n    function Templater(templateText) {\n      return new Function(\n        \"page\",\n        \"var output=\" +\n          JSON.stringify(templateText)\n            .replace(/<%=(.+?)%>/g, '\"+($1)+\"')\n            .replace(/<%(.+?)%>/g, '\";$1\\noutput+=\"') +\n          \";return output;\"\n      );\n    }\n\n    const api = {\n      init: () => {\n        let templates = [].slice.call(\n          rootEl.querySelectorAll('script[type=\"text/template\"]')\n        );\n        templates.forEach((template) => {\n          let id = template.getAttribute(\"id\");\n          if (id && template.textContent) {\n            templateCache[id] = Templater(template.textContent);\n          }\n        });\n      },\n      register: (name, templateText) => {\n        if (templateCache[name]) {\n            if (!opts.clobber) {\n                throw new Error(`A template named \"${name}\" is already registered!`);\n            }\n        }\n        templateCache[name] = Templater(templateText);\n        if (listeners[name]) {\n            listeners[name].forEach(handler => {\n                handler(templateCache[name]);\n            });\n        }\n      },\n      registerFromUrl: async (name, url, onError) => {\n        if (templateCache[name] && !opts.clobber) {\n          onError\n            ? onError(\n                `A template with the name \"${name}\" is already registered!`\n              )\n            : null;\n          return;\n        }\n\n        try {\n            let res = await fetch(url);\n            let templateText = await res.text();\n            templateCache[name] = Templater(templateText);\n            if (listeners[name]) {\n                listeners[name].forEach(handler => {\n                    handler(templateCache[name]);\n                });\n            }\n        } catch (err) {\n            if (app.debug) {\n                console.error(`[webx1TemplaterPlugin] Failed to fetch remote template`, err);\n            }\n            onError && onError(err);\n        }\n      },\n      ready: (name, callback) => {\n        if (!listeners[name]) {\n            listeners[name] = [];\n        }\n        listeners[name].push(callback);\n\n        if (templateCache[name]) {\n            callback(templateCache[name]);\n        }\n      },\n      render: (name, obj) => {\n        if (!templateCache[name]) {\n          throw new Error(\n            `Unknown template \"${name}\". Did you register it first?`\n          );\n        }\n        return templateCache[name](obj);\n      },\n      renderTo(name, obj, el, callback) {\n        let elem = el;\n        if (!el) {\n          throw new Error(\"An element is required to bind!\");\n        }\n        if (typeof el === \"string\") {\n          elem = document.querySelector(el);\n        }\n\n        if (!templateCache[name]) {\n          console.warn(\n            `[webx1TemplaterPlugin] Missing template \"${name}\" on bind! Is it registered?`\n          );\n          return;\n        }\n        elem.innerHTML = templateCache[name](obj);\n        if (callback && typeof callback === \"function\") {\n          callback(el, name, obj);\n        }\n      },\n    };\n\n    return api;\n  },\n};\n","import webx1TemplaterPlugin from './index';\n\nif (typeof window !== undefined) {\n    window.webx1TemplaterPlugin = webx1TemplaterPlugin;\n}"],"names":["addClass","cls","el","classList","add","apply","split","Array","isArray","_removeClassArr","arr","forEach","contains","remove","name","global","namespace","install","app","options","opts","Object","assign","activeClassName","origInitRoute","initRoute","origUnmountRoute","unmountRoute","origBoot","boot","rootEl","scope","document","querySelector","route","state","routeMap","keys","routes","reduce","prev","curr","rt","root","path","activeClass","slice","call","querySelectorAll","anchor","dataset","addEventListener","e","preventDefault","target","href","currPath","replace","window","location","origin","history","pushState","navigate","pathname","link","getRoute","currentRoute","getRouteElements","undefined","webx1NavPlugin","defaultOptions","speed","webx1TyperPlugin","run","text","textContent","typewriter","hasAttribute","parseInt","getAttribute","typeIt","repeat","append","i","txt","origText","api","str","ts","length","charAt","setTimeout","bind","stop","clearTimeout","clobber","webx1TemplaterPlugin","templateCache","listeners","Templater","templateText","Function","JSON","stringify","init","template","id","register","Error","handler","registerFromUrl","url","onError","body","recover","result","fetch","res","then","err","debug","console","error","ready","callback","push","render","obj","renderTo","elem","innerHTML","warn"],"mappings":"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"}